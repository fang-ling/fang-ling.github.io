<!DOCTYPE html>
<html lang='en'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'><link type='text/css' href='https://fonts.googleapis.com/css?family=Gentium+Book+Basic:400,700italic,700,400italic:latin' rel='stylesheet'><link rel='stylesheet' type='text/css' href='https://cdn.jsdelivr.net/npm/lxgw-wenkai-tc-webfont@1.2.0/style.css'><link rel='stylesheet' href='style.css' type='text/css'><title>Mastering Divide-and-Conquer: Strategies and Applications</title><!--Custom head-->
<link rel="icon" type="image/png" href="images/apple-touch-icon.png">
<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$']],
    displayMath: [['$$', '$$']],
    macros: {      phi:"\\varphi"    }
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link href='gist-embed.css' type='text/css' rel='stylesheet'></head><body><h1 class='title-text'><strong>Mastering Divide-and-Conquer: Strategies and Applications</strong></h1><div class='purplebox head-box'>Undergraduate&nbsp;&nbsp;&bull;&nbsp;&nbsp;Guitar Player&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href='gear.html'>Gear</a>&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href='https://github.com/fang-ling'>GitHub</a></div><div class='page-container'><p>In divide-and-conquer, we solve a problem recursively, applying three steps at each level of the recursion:</p>
<ul>
<li><strong>Divide</strong> the problem into a number of subproblems that are smaller instances of the same problem.</li>
<li><strong>Conquer</strong> the subproblems by solving them recursively, If the subproblem sizes are small enough, however, just solve the subproblems in a straightforward manner.</li>
<li><strong>Combine</strong> the solutions to the subproblems into the solution for the original problem.</li>
</ul>
<h2>The maximum-subarray problem</h2>
<p>Given an array of $n$ integers, find the contiguous subarray with the largest sum. (This problem is interesting only when the array contains some negative numbers. If all the array elements were nonnegative, then this problem would present no challenge, since the entire array would give the largest sum.)</p>
<p>For example, given the array $[-2, 1, -3, 4, -1, 2, 1, -5, 4]$, the contiguous subarray with the largest sum is $[4, -1, 2, 1]$, which has a sum of $6$.</p>
<p>Let's think about how we can solve the maximum-subarray problem using the divide-and-conquer technique. Suppose we want to find a maximum subarray of the subarray $A[low...high]$. Divide-and-conquer suggests that we divide the subarray into two subarrays of as equal size as possible. That is, we find a midpoint, say $mid$, of the subarray, and consider the subarrays $A[low...mid]$ and $A[mid + 1...high]$. Any contiguous subarray $A[i...j]$ of $A[low...high]$ must lie in exactly one of the following places:</p>
<ul>
<li>entirely in the subarray $A[low...mid]$, so that $low\leq i\leq j\leq mid$,</li>
<li>entirely in the subarray $A[mid + 1...high]$, so that $mid&lt;i\leq j\leq high$, or</li>
<li>crossing the midpoint, so that $low\leq i\leq mid&lt;j\leq high$.</li>
</ul>
<p>We can find maximum subarrays of $A[low...mid]$ and $A[mid+1...high]$ recursively, beacause these two subproblems are smaller instances of the problem of finding a maximum subarray. Thus, all that is left to do is find a maximum subarray that crosses the midpoint, and take a subarray with the largest sum of the three.</p>
<p>Any subarray crossing the midpoint is itself make of two subarrays $A[i...mid]$ and $A[mid+1...j]$, where $low\leq i\leq mid$ and $mid&lt;j\leq high$. Therefore, we just need to find maximum subarrays of the form $A[i ...mid]$ and $A[mid+1...j]$ and then combine them. The function <code>find_max_crossing_subarray</code> takes as input the array <code>A</code> and the indices <code>low</code>, <code>mid</code> and <code>high</code>, and it returns a tuple containing the indices demarcating a maximum subarray that crosses the midpoint, along with the sum of the values in a maximum subarray.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div class='Box-body p-0 blob-wrapper data' itemprop='text'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td data-line-number='1' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">func</span> find_max_crossing_subarray(</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'>  _ A : [Int],</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='3'></td><td class='blob-code blob-code-inner js-file-line'>  _ low : Int,</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='4'></td><td class='blob-code blob-code-inner js-file-line'>  _ mid : Int,</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'>  _ high : Int</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='6'></td><td class='blob-code blob-code-inner js-file-line'>) -&gt; (Int, Int, Int) {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> max_left = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='8'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> max_right = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> left_sum = Int.min</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='10'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> right_sum = Int.min</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='12' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> sum = <span class="pl-c1">0</span></td></tr><tr><td data-line-number='13' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">for</span> i <span class="pl-k">in</span> (low ... mid).reversed() {</td></tr><tr><td data-line-number='14' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        sum += A[i]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='15'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> sum &gt; left_sum {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>            left_sum = sum</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            max_left = i</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='18'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td data-line-number='19' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='20' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    sum = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='21'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">for</span> j <span class="pl-k">in</span> mid + <span class="pl-c1">1</span> ... high {</td></tr><tr><td data-line-number='22' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        sum += A[j]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='23'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> sum &gt; right_sum {</td></tr><tr><td data-line-number='24' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            right_sum = sum</td></tr><tr><td data-line-number='25' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            max_right = j</td></tr><tr><td data-line-number='26' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td data-line-number='27' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='28'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">return</span> (max_left, max_right, left_sum + right_sum)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='29'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>We claim that the call <code>find_max_crossing_subarray</code> takes $\Theta(n)$ time. With a linear-time  <code>find_max_crossing_subarray</code>  function in hand, we can write code for a divide-and-conquer algorithm to solve the maximum-subarray problem:</p>
<div class='gist'><div class='gist-file' translate='no'><div class='gist-data'><div><div class='file my-2'><div class='Box-body p-0 blob-wrapper data' itemprop='text'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td data-line-number='1' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">func</span> find_maximum_subarray(</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'>  _ A : [Int],</td></tr><tr><td data-line-number='3' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ low : Int,</td></tr><tr><td data-line-number='4' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ high : Int</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'>) -&gt; (Int, Int, Int) {</td></tr><tr><td data-line-number='6' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">if</span> low == high { <span class="pl-c">/* Base case: only one element */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">return</span> (low, high, A[low])</td></tr><tr><td data-line-number='8' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    } <span class="pl-k">else</span> {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> mid = (low + high) / <span class="pl-c1">2</span></td></tr><tr><td data-line-number='10' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> left = find_maximum_subarray(A, low, mid)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> right = find_maximum_subarray(A, mid + <span class="pl-c1">1</span>, high)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> cross = find_max_crossing_subarray(A, low, mid, high)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='13'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='14'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> left.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> &gt;= right.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> && left.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> &gt;= cross.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='15'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">return</span> left</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>        } <span class="pl-k">else</span> <span class="pl-k">if</span> right.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> &gt;= left.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> && right.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> &gt;= cross.<span class="pl-c1"><span class="pl-c1"><span class="pl-c1"><span class="pl-c1">2</span></span></span></span> {</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">return</span> right</td></tr><tr><td data-line-number='18' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        } <span class="pl-k">else</span> {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='19'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">return</span> cross</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='20'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='21'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='22' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>Related problem: <a href="https://leetcode.com/problems/maximum-subarray/">LeetCode 53. Maximum Subarray</a>.</p>
<p>Next we set up a recurrence that describes the running time of the recursive function:</p>
<p>$$T(n)=\begin{cases}\Theta(1)&n=1,\\2T(n/2)+\Theta(n)&n&gt;1.\end{cases}$$</p>
<p>As we shall see from the method mentioned in the following section, this recurrence has the solution $T(n)=\Theta(n\lg n)$.</p>
<h2>The Merge Sort Algorithm</h2>
<p>The merge sort algorithm is a divide-and-conquer algorithm that recursively splits an array into halves, sorts them individually, and then merges them back together in a sorted order.</p>
<p>The key operation of the merge sort algorithm is the merging of two sorted sequences in the &quot;combine&quot; step. The way of merging two sorted arrays is very similar to the process of merging two piles of playing cards. Each pile is sorted, with the smallest cards on top. Our basic step consists of choosing the smaller of the two cards on top of the piles, removing it from its pile (which exposes a new top card), and placing this card onto the output pile. We repeat this step until one input pile is empty, at which time we just take the remaining input pile and place it onto the output pile. Computationally, each basic step takes constant time. Since we perform at most $n$ basic steps, merging takes $\Theta(n)$ time.</p>
<p>The following Swift code implements the above idea.</p>
<div class='gist'><div class='gist-file' translate='no'><div class='gist-data'><div><div class='file my-2'><div class='Box-body p-0 blob-wrapper data' itemprop='text'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td data-line-number='1' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>@inlinable</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">func</span> merge&lt;T : Comparable&gt;(</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='3'></td><td class='blob-code blob-code-inner js-file-line'>  _ array : <span class="pl-k">inout</span> [T],</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='4'></td><td class='blob-code blob-code-inner js-file-line'>  _ p : Int,</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'>  _ q : Int,</td></tr><tr><td data-line-number='6' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ r : Int</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'>) {</td></tr><tr><td data-line-number='8' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">let</span> left = Array(array[p ... q])</td></tr><tr><td data-line-number='9' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">let</span> right = Array(array[q + <span class="pl-c1">1</span> ... r])</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='10'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='11' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> i = p</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> j = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='13'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> k = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='14'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">while</span> j &lt; left.count && k &lt; right.count {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='15'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> left[j] &lt;= right[k] {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>            array[i] = left[j]</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            j += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='18'></td><td class='blob-code blob-code-inner js-file-line'>        } <span class="pl-k">else</span> {</td></tr><tr><td data-line-number='19' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            array[i] = right[k]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='20'></td><td class='blob-code blob-code-inner js-file-line'>            k += <span class="pl-c1">1</span></td></tr><tr><td data-line-number='21' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td data-line-number='22' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        i += <span class="pl-c1">1</span></td></tr><tr><td data-line-number='23' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='24'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='25' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">while</span> j &lt; left.count {</td></tr><tr><td data-line-number='26' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        array[i] = left[j]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='27'></td><td class='blob-code blob-code-inner js-file-line'>        i += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='28'></td><td class='blob-code blob-code-inner js-file-line'>        j += <span class="pl-c1">1</span></td></tr><tr><td data-line-number='29' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='30' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">while</span> k &lt; right.count {</td></tr><tr><td data-line-number='31' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        array[i] = right[k]</td></tr><tr><td data-line-number='32' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        i += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='33'></td><td class='blob-code blob-code-inner js-file-line'>        k += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='34'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='35'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>We can now use the <code>merge()</code> procedure as a subroutine in the merge sort algorithm. To sort the entire sequence, we make the initial call <code>merge_sort(&amp;array, 0, array.count - 1)</code>.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div class='Box-body p-0 blob-wrapper data' itemprop='text'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='1'></td><td class='blob-code blob-code-inner js-file-line'>@inlinable</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">func</span> merge_sort&lt;T : Comparable&gt;(_ array : <span class="pl-k">inout</span> [T], _ p : Int, _ r : Int) {</td></tr><tr><td data-line-number='3' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">if</span> p &lt; r {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='4'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> q = (p + r) / <span class="pl-c1">2</span></td></tr><tr><td data-line-number='5' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        merge_sort(&array, p, q)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='6'></td><td class='blob-code blob-code-inner js-file-line'>        merge_sort(&array, q + <span class="pl-c1">1</span>, r)</td></tr><tr><td data-line-number='7' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        merge(&array, p, q, r)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='8'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>Related problem: <a href="https://leetcode.com/problems/sort-an-array/description/">LeetCode 912. Sort an Array</a>.</p>
<p>The recurrence for the worst-case running time $T(n)$ of merge sort:</p>
<p>$$T(n)=\begin{cases}\Theta(1)&n=1,\\2T(n/2)+\Theta(n)&n&gt;1.\end{cases}$$</p>
<p>And its solution is $T(n)=\Theta(n\lg n)$.</p>
</div><div class='purplebox foot-box'><i>Last updated June 13, 2023 by <a href='index.html'>Fang Ling</a>.</i></div><br><div class='footer'>Made with ♡<a href='index.html'>by Fang Ling</a><a href='https://github.com/fang-ling/zyy'>zyy v0.1.4</a><span>Build: 225</span><br>Blog theme is highly inspired<a href='https://erikdemaine.org'>by Prof. Erik Demaine</a><p class='copyright'>© 2018-2023 Fang Ling</p></div></body></html>