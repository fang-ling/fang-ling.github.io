<!DOCTYPE html>
<html lang='en'><head><meta charset='UTF-8'><meta content='width=device-width initial-scale=1' name='viewport'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Gentium+Book+Basic:400,700italic,700,400italic:latin'><link rel='stylesheet' type='text/css' href='https://cdn.jsdelivr.net/npm/lxgw-wenkai-tc-webfont@1.2.0/style.css'><link href='style.css' rel='stylesheet' type='text/css'><title>Elementary Graph Algorithms</title><!--Custom head-->
<link rel="icon" type="image/png" href="images/apple-touch-icon.png">
<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$']],
    displayMath: [['$$', '$$']],
    macros: {      phi:"\\varphi"    }
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link rel='stylesheet' type='text/css' href='gist-embed.css'></head><body><h1 class='title-text'><strong>Elementary Graph Algorithms</strong></h1><div class='purplebox head-box'>Undergraduate&nbsp;&nbsp;&bull;&nbsp;&nbsp;Guitar Player&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href='gear.html'>Gear</a>&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href='https://github.com/fang-ling'>GitHub</a></div><div class='page-container'><h2>Representations of graphs</h2>
<p>We can choose between two standard ways to represent a graph $G=(V,E)$ as a collection of adjacency lists or as an adjacency matrix. Either way applies to both directed and undirected graphs.</p>
<p>The <strong>adjacency-list representation</strong> of a graph $G=(V,E)$ consists of an array $Adj$ of $|V|$ lists, one for each vertex in $V$. For each $u\in V$, the adjacency list $Adj[u]$ contains all the vertices $v$ such that there is an edge $(u,v)\in E$. That is, $Adj[u]$ consists of all vertices adjacent to $u$ in $G$.
Fun fact is that if $G$ is a directed graph, the sum of the lengths of all the adjacency lists is $|E|$. If $G$ is an undirected graph, the sum of the lengths of all the adjacency lists is $2|E|$.
In practice, an adjacency list can be represented using an array of arrays. The following code shows the idea.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div itemprop='text' class='Box-body p-0 blob-wrapper data'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='1'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">import</span> Foundation</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='3'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">public</span> <span class="pl-k">struct</span> AdjacencyEdge : Equatable {</td></tr><tr><td data-line-number='4' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">var</span> v : Int</td></tr><tr><td data-line-number='5' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">var</span> weight : Int</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='6'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='8'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">public</span> <span class="pl-k">struct</span> AdjacencyList {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* Number of vertices in this graph */</span></td></tr><tr><td data-line-number='10' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">var</span> count : Int</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> adj : [[AdjacencyEdge]]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='13'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> init(count : Int) {</td></tr><tr><td data-line-number='14' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        self.count = count</td></tr><tr><td data-line-number='15' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        adj = [[AdjacencyEdge]](</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>          repeating: [AdjacencyEdge](),</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='17'></td><td class='blob-code blob-code-inner js-file-line'>          count: count</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='18'></td><td class='blob-code blob-code-inner js-file-line'>        )</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='19'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='20'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='21' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">func</span> get_adj_list(u : Int) -&gt; [AdjacencyEdge] {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='22'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">return</span> adj[u]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='23'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='24'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='25' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">mutating</span> <span class="pl-k">func</span> insert_edge(u : Int, v : Int, weight : Int = <span class="pl-c1">1</span>) {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='26'></td><td class='blob-code blob-code-inner js-file-line'>        adj[u].append(AdjacencyEdge(v: v, weight: weight))</td></tr><tr><td data-line-number='27' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='28' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='29'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* O(n) time */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='30'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">mutating</span> <span class="pl-k">func</span> contains(u : Int, v : Int) -&gt; Bool {</td></tr><tr><td data-line-number='31' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">for</span> e <span class="pl-k">in</span> adj[u] {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='32'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">if</span> e.v == v {</td></tr><tr><td data-line-number='33' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>                <span class="pl-k">return</span> <span class="pl-k">true</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='34'></td><td class='blob-code blob-code-inner js-file-line'>            }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='35'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td data-line-number='36' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">return</span> <span class="pl-k">false</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='37'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='38'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>For the <strong>adjacency-matrix representation</strong> of a graph $G=(V,E)$, we assume that the vertices are numbered $0,1,...,|V|$. Then the adjacency-matrix representation of a graph $G$ consists of a $|V|\times|V|$ matrix $A=(a_{ij})$ such that
$$a_{ij}=\begin{cases}w_{ij}&\text{if }(i,j)\in E,\\0&\text{otherwise}.\end{cases}$$</p>
<p>In real-world applications, an adjacency matrix can be represented using a two-dimensional array, as demonstrated in the following code.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div itemprop='text' class='Box-body p-0 blob-wrapper data'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td data-line-number='1' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">public</span> <span class="pl-k">struct</span> AdjacencyMatrix {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* Number of vertices in this graph */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='3'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">var</span> count : Int</td></tr><tr><td data-line-number='4' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> matrix : [[Int]]</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='6' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> init(count : Int) {</td></tr><tr><td data-line-number='7' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        self.count = count</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='8'></td><td class='blob-code blob-code-inner js-file-line'>        matrix = [[Int]](</td></tr><tr><td data-line-number='9' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>          repeating: [Int](repeating: <span class="pl-c1">0</span>, count: count),</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='10'></td><td class='blob-code blob-code-inner js-file-line'>          count: count</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'>        )</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='13'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='14'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">mutating</span> <span class="pl-k">func</span> insert_edge(u : Int, v : Int, weight : Int = <span class="pl-c1">1</span>) {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='15'></td><td class='blob-code blob-code-inner js-file-line'>        matrix[u][v] = weight</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='18'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">func</span> contains(u : Int, v : Int) -&gt; Bool {</td></tr><tr><td data-line-number='19' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">return</span> matrix[u][v] != <span class="pl-c1">0</span></td></tr><tr><td data-line-number='20' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='21' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='22'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">mutating</span> <span class="pl-k">func</span> remove_edge(u : Int, v : Int) {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='23'></td><td class='blob-code blob-code-inner js-file-line'>        matrix[u][v] = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='24'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='25'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='26' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">public</span> <span class="pl-k">func</span> get_edge(u : Int, v : Int) -&gt; Int {</td></tr><tr><td data-line-number='27' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">return</span> matrix[u][v]</td></tr><tr><td data-line-number='28' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='29'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<h2>Depth-first search</h2>
<p>Depth-first search (DFS) is an algorithm for searching the vertices of a graph, that works by exploring as far into the graph as possible before backtracking.</p>
<p>It is useful to define the following &quot;colors&quot; for vertices in order to keep track of the state of the algorithm:</p>
<ul>
<li><strong>White</strong>: vertices are white before they are discovered.</li>
<li><strong>Gray</strong>: vertices are gray when they are discovered but their outgoing edges are still in the process of being explored.</li>
<li><strong>Black</strong>: vertices are black when the entire subtree starting at the vertex has been explored.</li>
</ul>
<p>We also find it useful to maintain a timeline of the search. We keep track of a time at each step, and the following events:</p>
<ul>
<li><code>d[u]</code>: the time at which we discover vertex u, i.e., the time it becomes gray.</li>
<li><code>f[u]</code>: the time at which we finish exploring all edges out of vertex u, i.e., the time it becomes black.</li>
</ul>
<p>The following Swift code is the basic depth-first-search algorithm. The input graph $G$ may be undirected or directed. The variable $time$ is a global variable that we use for time stamping.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div class='Box-body p-0 blob-wrapper data' itemprop='text'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='1'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">import</span> Foundation</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">import</span> Collections</td></tr><tr><td data-line-number='3' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='4'></td><td class='blob-code blob-code-inner js-file-line'>@usableFromInline</td></tr><tr><td data-line-number='5' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">enum</span> DFSColor {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='6'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> white</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> gray  <span class="pl-c">/* It is discovered in the search. */</span></td></tr><tr><td data-line-number='8' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> black <span class="pl-c">/* It is finished */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='10'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'>@usableFromInline</td></tr><tr><td data-line-number='12' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">var</span> time : Int = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='13'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='14'></td><td class='blob-code blob-code-inner js-file-line'>@inlinable</td></tr><tr><td data-line-number='15' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">public</span> <span class="pl-k">func</span> dfs(G : AdjacencyList) {</td></tr><tr><td data-line-number='16' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> color = [DFSColor](repeating: .white, count: G.count)</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* Predecessor */</span></td></tr><tr><td data-line-number='18' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> π = [Int](repeating: -<span class="pl-c1">1</span>, count: G.count)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='19'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* Timestamps */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='20'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> d = [Int](repeating: <span class="pl-c1">0</span>, count: G.count)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='21'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> f = [Int](repeating: <span class="pl-c1">0</span>, count: G.count)</td></tr><tr><td data-line-number='22' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='23'></td><td class='blob-code blob-code-inner js-file-line'>    time = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='24'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">for</span> u <span class="pl-k">in</span> <span class="pl-c1">0</span> ..&lt; G.count {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='25'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> color[u] == .white {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='26'></td><td class='blob-code blob-code-inner js-file-line'>            dfs_visit(G, &π, &color, &d, &f, u)</td></tr><tr><td data-line-number='27' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td data-line-number='28' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='29'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='30'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='31' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>@usableFromInline</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='32'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">func</span> dfs_visit(</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='33'></td><td class='blob-code blob-code-inner js-file-line'>  _ G : AdjacencyList,</td></tr><tr><td data-line-number='34' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ π : <span class="pl-k">inout</span> [Int],</td></tr><tr><td data-line-number='35' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ color : <span class="pl-k">inout</span> [DFSColor],</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='36'></td><td class='blob-code blob-code-inner js-file-line'>  _ d : <span class="pl-k">inout</span> [Int],</td></tr><tr><td data-line-number='37' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ f : <span class="pl-k">inout</span> [Int],</td></tr><tr><td data-line-number='38' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>  _ u : Int</td></tr><tr><td data-line-number='39' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>) {</td></tr><tr><td data-line-number='40' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    time += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='41'></td><td class='blob-code blob-code-inner js-file-line'>    d[u] = time</td></tr><tr><td data-line-number='42' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    color[u] = .gray</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='43'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='44'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">for</span> e <span class="pl-k">in</span> G.adj[u] {</td></tr><tr><td data-line-number='45' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> v = e.v</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='46'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">if</span> color[v] == .white {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='47'></td><td class='blob-code blob-code-inner js-file-line'>            π[v] = u</td></tr><tr><td data-line-number='48' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            dfs_visit(G, &π, &color, &d, &f, v)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='49'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='50'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='51' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    color[u] = .black</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='52'></td><td class='blob-code blob-code-inner js-file-line'>    time += <span class="pl-c1">1</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='53'></td><td class='blob-code blob-code-inner js-file-line'>    f[u] = time</td></tr><tr><td data-line-number='54' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>Another interesting property of depth-first search is that the search can be used to classify the edges of the input graph $G=(V,E)$. Knowing the type of each edge can be very useful; for example, we can determine whether a directed graph is acyclic by checking if a depth-first search yields any &quot;back&quot; edges.</p>
<p>Formally, we define the types of edges as follows:</p>
<ul>
<li><strong>Tree edges</strong> are those traversed in the <code>dfs_visit</code> routine.</li>
<li><strong>Back edges</strong> are any edge, $(u, v)$, such that $u$ is a descendant of $v$.</li>
<li><strong>Forward edges</strong> are any non-tree edge, $(u, v)$, such that $v$ is a descendant of $u$.</li>
<li><strong>Cross edges</strong> are any other edge. These are the edges that go between subtrees or trees in the forest.</li>
</ul>
<p>Here is a modified version of the pseudocode for depth-first search so that it prints out every edge in the graph $G$, together with its type.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div itemprop='text' class='Box-body p-0 blob-wrapper data'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='1'></td><td class='blob-code blob-code-inner js-file-line'>DFS-VISIT-PRINT(G, u)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'>    time = time + 1</td></tr><tr><td data-line-number='3' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    u.d = time</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='4'></td><td class='blob-code blob-code-inner js-file-line'>    u.color = GRAY</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'>    for each vertex v ∈ G.Adj[u]</td></tr><tr><td data-line-number='6' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        if v.color == WHITE</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='7'></td><td class='blob-code blob-code-inner js-file-line'>            print "(u, v) is a tree edge."</td></tr><tr><td data-line-number='8' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            v.π = u</td></tr><tr><td data-line-number='9' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            DFS-VISIT-PRINT(G, v)</td></tr><tr><td data-line-number='10' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        else if v.color == GRAY</td></tr><tr><td data-line-number='11' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            print "(u, v) is a back edge."</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'>        else if v.d &gt; u.d</td></tr><tr><td data-line-number='13' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            print "(u, v) is a forward edge."</td></tr><tr><td data-line-number='14' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        else</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='15'></td><td class='blob-code blob-code-inner js-file-line'>            print "(u, v) is a cross edge."</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>    u.color = BLACK</td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    time = time + 1</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='18'></td><td class='blob-code blob-code-inner js-file-line'>    u.f = time</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>Related problem: <a href="https://leetcode.com/problems/course-schedule/description/">LeetCode 207. Course Schedule</a>.</p>
<p>The <strong>example</strong> demonstrates how depth-first search works on the following graph. Assume that the DFS procedure considers the vertices in alphabetical order, and assume that each adjacency list is ordered alphabetically.</p>
<img src="images/elementary-graph-algorithms-1.webp" style="width:100%">
<h2>Breadth-first search</h2>
<p>Given a graph $G=(V,E)$ and a distinguished source vertex $s$, <strong>breadth-first search</strong> (BFS) systematically explores the edges of $G$ to &quot;discover&quot; every vertex that is reachable from $s$. It is so named because it expands the frontier between discovered and undiscovered vertices uniformly across the breadth of the frontier.</p>
<p>The code that follows illustrates the BFS algorithm.</p>
<div class='gist'><div translate='no' class='gist-file'><div class='gist-data'><div><div class='file my-2'><div itemprop='text' class='Box-body p-0 blob-wrapper data'><div class='js-check-bidi js-blob-code-container blob-code-content'><table class='highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file'><tbody><tr><td data-line-number='1' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>@usableFromInline</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='2'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">enum</span> BFSColor {</td></tr><tr><td data-line-number='3' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> white</td></tr><tr><td data-line-number='4' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> gray</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='5'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">case</span> black</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='6'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr><tr><td data-line-number='7' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='8'></td><td class='blob-code blob-code-inner js-file-line'>@inlinable</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='9'></td><td class='blob-code blob-code-inner js-file-line'><span class="pl-k">public</span> <span class="pl-k">func</span> bfs(G : AdjacencyList, s : Int) -&gt; [Int] {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='10'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-c">/* Initialization */</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='11'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> color = [BFSColor](repeating: .white, count: G.count)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='12'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> d = [Int](repeating: Int.max, count: G.count)</td></tr><tr><td data-line-number='13' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> π = [Int?](repeating: nil, count: G.count)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='14'></td><td class='blob-code blob-code-inner js-file-line'>    color[s] = .gray</td></tr><tr><td data-line-number='15' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    d[s] = <span class="pl-c1">0</span></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='16'></td><td class='blob-code blob-code-inner js-file-line'>    π[s] = <span class="pl-k">nil</span></td></tr><tr><td data-line-number='17' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td data-line-number='18' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">var</span> Q = Queue&lt;Int&gt;()</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='19'></td><td class='blob-code blob-code-inner js-file-line'>    Q.enqueue(s)</td></tr><tr><td data-line-number='20' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">while</span> !Q.is_empty {</td></tr><tr><td data-line-number='21' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">let</span> u = Q.dequeue()</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='22'></td><td class='blob-code blob-code-inner js-file-line'>        <span class="pl-k">for</span> e <span class="pl-k">in</span> G.adj[u] {</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='23'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">let</span> v = e.v</td></tr><tr><td data-line-number='24' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>            <span class="pl-k">if</span> color[v] == .white {</td></tr><tr><td data-line-number='25' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>                color[v] = .gray</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='26'></td><td class='blob-code blob-code-inner js-file-line'>                d[v] = d[u] + <span class="pl-c1">1</span></td></tr><tr><td data-line-number='27' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>                π[v] = u</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='28'></td><td class='blob-code blob-code-inner js-file-line'>                Q.enqueue(v)</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='29'></td><td class='blob-code blob-code-inner js-file-line'>            }</td></tr><tr><td data-line-number='30' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>        }</td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='31'></td><td class='blob-code blob-code-inner js-file-line'>        color[u] = .black</td></tr><tr><td data-line-number='32' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>    }</td></tr><tr><td data-line-number='33' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'></></td></tr><tr><td class='blob-num js-line-number js-code-nav-line-number js-blob-rnum' data-line-number='34'></td><td class='blob-code blob-code-inner js-file-line'>    <span class="pl-k">return</span> d</td></tr><tr><td data-line-number='35' class='blob-num js-line-number js-code-nav-line-number js-blob-rnum'></td><td class='blob-code blob-code-inner js-file-line'>}</td></tr></tbody></table></div></div></div></div></div><div class='gist-meta'>Rendered with ♡ by <a href='https://github.com/fang-ling/zyy'>zyy</a></div></div></div>
<p>The following figure illustrates the progress of BFS on a sample graph.</p>
<img src="images/elementary-graph-algorithms-2.webp" style="width:100%">
<h2>Sources</h2>
<ol>
<li>CORMEN, Thomas H., et al. Introduction to algorithms. MIT press, 2009.ISBN 978-0-262-03384-8.</li>
<li><a href="https://www.cs.cmu.edu/afs/cs/academic/class/15750-s18/ScribeNotes/lecture9.pdf">CMU 15-750 Graduate Algorithms February 6, 2017 Lecture 9: Graph Algorithms: Depth-First Search</a></li>
<li><a href="https://walkccc.me/CLRS/Chap22/22.3/">CLRS Solution 22.3-10</a></li>
</ol>
</div><div class='purplebox foot-box'><i>Last updated September 21, 2023 by <a href='index.html'>Fang Ling</a>.</i></div><br><div class='footer'>Made with ♡<a href='index.html'>by Fang Ling</a><a href='https://github.com/fang-ling/zyy'>zyy v0.1.4</a><span>Build: 1ee</span><br>Blog theme is highly inspired<a href='https://erikdemaine.org'>by Prof. Erik Demaine</a><p class='copyright'>© 2018-2023 Fang Ling</p></div></body></html>